<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Response Page</title>
  </head>

  <script type="text/javascript">
    /*http://127.0.0.1/response?
merchantId=508029
merchant_name=Test+PayU
merchant_address=Av+123+Calle+12
telephone=7512354
merchant_url=http%3A%2F%2Fpruebaslapv.xtrweb.com
transactionState=4
lapTransactionState=APPROVED
message=APPROVED
referenceCode=TestAlejoT
reference_pol=2148103329
transactionId=f3039aa9-f704-4fe8-b8aa-ba15107da0b6
description=Test+PAYU
trazabilityCode=CRED+-+666401355
cus=CRED+-+666401355
orderLanguage=es
extra1=
extra2=
extra3=
polTransactionState=4
signature=862a432ad7d281563692518d4298d7db
polResponseCode=1
lapResponseCode=APPROVED
risk=
polPaymentMethod=10
lapPaymentMethod=VISA
polPaymentMethodType=2
lapPaymentMethodType=CREDIT_CARD
installmentsNumber=1
TX_VALUE=2000.00
TX_TAX=.00
currency=COP
lng=es
pseCycle=
buyerEmail=test%40test.com
pseBank=
pseReference1=
pseReference2=
pseReference3=
authorizationCode=725021
TX_ADMINISTRATIVE_FEE=.00
TX_TAX_ADMINISTRATIVE_FEE=.00
TX_TAX_ADMINISTRATIVE_FEE_RETURN_BASE=.00
processingDate=2022-11-20

*/

    window.onload = function () {
      try {
        let url_string = window.location.href.toLowerCase();
        let url = new URL(url_string);
        let buyerEmail = url.searchParams.get("buyerEmail");
        let merchantId = url.searchParams.get("merchantId");
        let merchantName = url.searchParams.get("merchant_name");
        let referenceCode = url.searchParams.get("referenceCode");
        let desc = url.searchParams.get("description");
        let messageStatus = url.searchParams.get("message");
        let total = url.searchParams.get("TX_VALUE");
        let signature = url.searchParams.get("signature");
        let currency = url.searchParams.get("currency");
        let transactionState = url.searchParams.get("transactionState");
        let lapTransactionState = url.searchParams.get("lapTransactionState");
        // let firma_cadena = url.searchParams.get("firma_cadena");
        // let firmacreada = url.searchParams.get("firmacreada");
        // let firma = url.searchParams.get("firma");
        let reference_pol = url.searchParams.get("reference_pol");
        let cus = url.searchParams.get("cus");
        let extra1 = url.searchParams.get("extra1");
        let pseBank = url.searchParams.get("pseBank");
        let lapPaymentMethod = url.searchParams.get("lapPaymentMethod");
        let lapPaymentMethodType = url.searchParams.get("lapPaymentMethodType");
        let installmentsNumber = url.searchParams.get("installmentsNumber");
        let transactionId = url.searchParams.get("transactionId");
        let processingDate = url.searchParams.get("processingDate");

        document.getElementById("status").innerHTML = messageStatus;
        document.getElementById("idTransaction").innerHTML = transactionId;
        document.getElementById("ref_sell").innerHTML = merchantName;
        document.getElementById("ref_trans").innerHTML = referenceCode;
        document.getElementById("cus").innerHTML = cus;
        document.getElementById("bank").innerHTML = pseBank;
        document.getElementById("total").innerHTML = total;
        document.getElementById("currency").innerHTML = currency;
        document.getElementById("desc").innerHTML = desc;
        document.getElementById("entity").innerHTML = lapPaymentMethod;
        document.getElementById("date").innerHTML = processingDate;

        console.log(url);
      } catch (err) {
        console.log("Issues with Parsing URL Parameter's - " + err);
      }
    };
  </script>

  <body>
    <h2>Resumen de la transacción</h2>

    <table>
      <tr>
        <td>Estado de la transacción</td>
        <td id="status"></td>
      </tr>
      <tr></tr>
      <tr>
        <td>ID de la transacción</td>
        <td id="idTransaction"></td>
      </tr>
      <tr>
        <td>Referencia de venta</td>
        <td id="ref_sell"></td>
      </tr>
      <tr>
        <td>Referencia de la transacción</td>
        <td id="ref_trans"></td>
      </tr>
      <tr>
        <td>cus</td>
        <td id="cus"></td>
      </tr>
      <tr>
        <td>Banco</td>
        <td id="bank"></td>
      </tr>
      <tr>
        <td>Valor total</td>
        <td id="total"></td>
      </tr>
      <tr>
        <td>Moneda</td>
        <td id="currency"></td>
      </tr>
      <tr>
        <td>Descripción</td>
        <td id="desc"></td>
      </tr>
      <tr>
        <td>Entidad:</td>
        <td id="entity"></td>
      </tr>
      <tr>
        <td>Fecha:</td>
        <td id="date"></td>
      </tr>
    </table>
  </body>
</html>
